<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Junwei Wang - Thesis</title><meta name=description content="Test"><meta name=author content="Junwei Wang"><link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2 crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css><link rel=stylesheet href=/sass/researcher.min.css><link rel=stylesheet href=/sass/style.min.css><link rel=icon type=image/ico href=https://jwa.ng/favicon.ico></head><body><div class="container mt-5"><nav class="navbar navbar-expand-sm flex-column flex-sm-row text-nowrap p-0"><a class="navbar-brand mx-0 mr-sm-auto" href=https://jwa.ng/>Junwei Wang</a><div class="navbar-nav flex-row flex-wrap justify-content-center"><a class="nav-item nav-link" href=/>About</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/thesis/>Thesis</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/contact/>Contact</a></div></nav></div><hr><div id=content><div class=container><h1 id=thesis>Thesis</h1><p>The defense of my thesis, entitled <strong>On the practical security of white-box cryptography</strong>, took place in June 24, 2020.
Here are my thesis <a href=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/267b6c31-196e-44bc-9196-6379f2114108/manuscript-20200918.pdf>manuscript</a> and <a href=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ed651733-c0e3-4edb-97f7-035e6b013be1/2020-phd-defense.pdf>presentation slides</a>.</p><p>The recording of my defense is available on YouTube:</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/cRsO9N8SuN4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=title>Title</h2><p>On the Practical Security of White-Box Cryptography</p><h2 id=jury-composition>Jury Composition</h2><ul><li>Pr. Alex BIRYUKOV, University of Luxembourg, Examiner</li><li>Pr. Jean-Sébastien CORON, University of Luxembourg, Co-supervisor</li><li>Pr. Pierre-Alain FOUQUE, Université Rennes 1, Reviewer</li><li>Pr. Sihem MESNAGER, Unviersité Paris 8, Co-supervisor</li><li>Pr. Bart PRENEEL, KU Leuven, Reviewer</li><li>Dr. Matthieu RIVAIN, CryptoExperts, Advisor</li><li>Pr. Wolfgang SCHMID, Unviersité Paris 8, President</li><li>Pr. François-Xavier STANDAERT, Université catholique de Louvain, Examiner</li></ul><h2 id=abstract>Abstract</h2><p>Cryptography studies how to secure communications and information. The security of a cryptosystem depends on the secrecy of the underlying key. White-box cryptography explores methods to hide a cryptographic key into some software deployed in the real world.</p><p>Classical cryptography only assumes that the adversary accesses the target cryptographic primitive in a black-box manner in which she can only observe or manipulate the input and output of the primitive, but cannot know or tamper with its internal details. The gray-box model further allows an adversary to exploit key-dependent sensitive information leaked from the execution of physical implementations. All sorts of side-channel attacks exploit some physical information leakage, such as the power consumption of the device. The white-box model considers the worst-case scenario in which the adversary has complete control over the software and its execution environment. The goal of white-box cryptography is to securely implement a cryptographic primitive against such a powerful adversary. Although the scientific community has proposed some candidate solutions to build white-box cryptography, all have proven ineffective. Consequently, this problem has remained open for almost two decades since the concept was introduced.</p><p>The continuous growth in market demand and the emerging potential applications have driven the industry to deploy secretly designed proprietary solutions. Although this paradigm of achieving security through obscurity contradicts the widely accepted Kerckhoffs' principle in cryptography, this is currently the only option for white-box cryptography. Security experts have reported how gray-box attacks could be used to extract keys from several publicly available white-box implementations. In a gray-box attack, the adversary adapts side-channel analysis techniques to the white-box context, i.e., to target computation traces made of noise-free runtime information instead of the noisy physical leakage. Gray-box attacks are generic since they do not require any a priori knowledge of the implementation and hence avoid costly reverse engineering. Some non-publicly scrutinized industrial white-box schemes in the market are believed to be under the threat of gray-box attacks.</p><p>This thesis focuses on the analysis and improvement of gray-box attacks and the associated countermeasures for white-box cryptography. We first provide an in-depth analysis of why gray-box attacks are capable of breaking the classical white-box design which is based on table encodings. Next, we introduce a new gray-box attack named linear decoding analysis and show that linearly encoding sensitive information is insufficient to protect the cryptographic software. Afterward, we describe how to combine state-of-the-art countermeasures to resist gray-box attacks and comprehensively elaborate on the (in)effectiveness of these combined countermeasures in terms of computation complexity. Finally, we introduce a new attack technique that exploits the data-dependency of the targeted implementation to substantially lower the complexity of the existing gray-box attacks on white-box cryptography. In addition to the theoretical analyses and new attack techniques introduced in this thesis, we report some attack experiments against practical white-box implementations. In particular, we could break the winning implementations of two consecutive editions of the well-known WhibOx white-box cryptography competition.</p><h2 id=résumé-abstract-in-french>Résumé (Abstract in French)</h2><p>La cryptographie est la science de la protection des communications et des données. La sécurité d&rsquo;un cryptosystème dépend du secret de la clé sous-jacente. La cryptographie en boîte blanche explore les méthodes permettant de cacher une clé dans un logiciel cryptographique déployé dans le monde réel.</p><p>La cryptographie classique suppose que l&rsquo;adversaire accède à la primitive cryptographique ciblée en boîte noire. Cela signifie qu&rsquo;elle ne peut qu&rsquo;observer et manipuler les entrées et les sorties de la primitive, mais ne peut pas connaître ou altérer son état interne. Le modèle en boîte grise permet en outre à un adversaire d&rsquo;observer des informations sensibles qui sont divulguées lors de l&rsquo;exécution d&rsquo;une implémentation de la primitive. Toutes sortes d&rsquo;attaques par canaux auxiliaires exploitent certaines fuites d&rsquo;informations physiques, telles que la consommation électrique de l&rsquo;appareil. Le modèle en boîte blanche considère le scénario le plus défavorable dans lequel l&rsquo;adversaire a un contrôle total sur le logiciel cryptographique et sur son environnement d&rsquo;exécution. Le rôle de la cryptographie en boîte blanche est d&rsquo;implémenter une primitive cryptographique de façon à protéger la clé secrète contre un tel adversaire. Bien que la communauté scientifique ait tenté à plusieurs reprises de solutionner ce problème, ces tentatives se sont toutes révélées inadéquates. Par conséquent, la construction d&rsquo;une solution de cryptographie en boîte blanche est resté un problème ouvert depuis l&rsquo;introduction du concept il y a deux décennies.</p><p>L&rsquo;émergence d&rsquo;applications avec de fortes contraintes de sécurité logicielle a poussé l&rsquo;industrie à développer des solutions propriétaires dont la sécurité repose (en partie) sur des secrets de conception. Bien que ce paradigme de sécurité par l&rsquo;obscurité contredise le principe de Kerckhoffs largement admis en cryptographie, c&rsquo;est actuellement la seule option s&rsquo;offrant à l&rsquo;industrie pour répondre au besoin de cryptographie en boîte blanche. Des experts en sécurité ont récemment démontré comment certaines attaques en boîtes grise pouvaient être utilisées pour extraire les clés de plusieurs implémentations en boîte blanche accessibles publiquement. Dans une attaque en boîte grise, l&rsquo;adversaire adapte des techniques d&rsquo;analyse par canaux auxiliaires au contexte boîte blanche, en replaçant la fuite physique par des traces de calcul faites des valeurs intermédiaires non-bruitées observées lors de l&rsquo;exécution. Les attaques en boîte grise sont génériques car elles ne nécessitent aucune connaissance a priori de l&rsquo;implémentation et évitent ainsi la nécessité pour l&rsquo;attaquant de recourir à une rétro-ingénierie coûteuse. Il semble que certaines solutions de cryptographie en boîte blanche actuellement déployée et n&rsquo;ayant pas fait l&rsquo;objet d&rsquo;un examen public soient menacées par ce type d&rsquo;attaques en boîte grise.</p><p>Cette thèse se concentre sur l&rsquo;analyse et l&rsquo;amélioration des attaques en boîte grise et des contre-mesures associées pour la cryptographie en boîte blanche. Nous présentons tout d&rsquo;abord une analyse approfondie des raisons pour lesquelles les attaques en boîte grise basiques sont capables de casser la technique classique de cryptographie en boîte blanche basée sur les encodages
de tables. Nous proposons également de nouvelles techniques d&rsquo;attaque en boîte grise significativement plus efficace contre ce type d&rsquo;encodages. Nous introduisons ensuite une nouvelle attaque en boîte grise appelée analyse par décodage linéaire qui permet de déjouer toute méthode de protection basée sur un encodage linéaire des variables internes au calcul. Par la suite, nous étudions la combinaison de différentes contre-mesures pour résister aux attaques en boîte grise et analysons en détail la complexité d&rsquo;attaques avancées contre ces contre-mesures combinées. Nous introduisons enfin une nouvelle technique d&rsquo;attaque qui exploite le graphe de calcul de l&rsquo;implémentation ciblée pour réduire considérablement la complexité des attaques en boîte grise sur la cryptographie en boîte blanche. Outre les analyses théoriques et nouvelles techniques d&rsquo;attaque introduites dans cette thèse, nous rapportons plusieurs expériences d&rsquo;attaque pratique contre divers implémentations en boîte blanche. Nous démontrons notamment comment nous avons pu casser les implémentations gagnantes des deux éditions consécutives de la compétition WhibOx.</p><h2 id=摘要-abstract-in-chinese>摘要 (Abstract in Chinese)</h2><p>密码学是一门研究保护数据和通信安全的科学。一个密码系统的安全性取决于其密钥的保密性。白盒密码学探索在现实世界中部署的软件中隐藏密钥的方法。</p><p>经典密码学仅假定敌手以黑盒的方式访问被研究的密码学原语, 在这种方式中，她只能观察或操作原语的输入和输出，而无法知道或篡改其内部细节。灰盒模型进一步允许敌手利用物理实现执行过程中泄露的与密钥相关的敏感信息。各种侧信道攻击都是利用一些物理信息泄露，比如设备的功耗。白盒模型考虑的是最坏的情况，即敌手完全控制了软件及其执行环境。白盒密码学的目标即是在敌手拥有上述强大能力的情况下，给出密码学原语的安全软件实现。尽管学术界提出了一些构建白盒密码学的候选方案，但事实证明这些方案都无效。因此，自概念提出以来，这个开放问题持续存在了近二十年。</p><p>白盒密码市场需求的持续增长和新兴的潜在应用促使工业界采用秘密设计的专有解决方案。尽管这种通过模糊来实现安全性的范例与密码学中被广泛接受的Kerckhoffs原则相悖，但这是在当前困境中的无奈之举。安全专家报道了如何使用灰盒攻击从几种公开的白盒实现中提取密钥。在灰盒攻击中，敌手将侧信道分析技术应用到白盒密码学中。她的研究对象是从软件运行时收集不带任何噪音计算数据而非带有噪声的物理泄漏。灰盒攻击是一种通用攻击，因为它们不需要关于攻击对象的任何先验知识，从而避免了代价高昂的逆向工程。市场上一些未经公开审阅的工业白盒计划被认为正受到灰盒攻击的威胁。</p><p>本论文主要研究针对白盒密码学进行的灰盒攻击的分析与改进以及相关对策。首先，我们深入分析了为什么灰盒攻击能够打破经典的基于编码表的白盒设计。接下来，我们介绍了一种新的称为线性解码分析的灰盒攻击，并阐释了仅通过对敏感信息进行线性编码的方式来保护软件中的密钥是不足够的。随后，我们将描述如何通过组合最新的对策来抵抗灰盒攻击，并从计算复杂性的角度全面阐述这些组合对策的有效性和无效性。最后，我们介绍了一种新的攻击技术，该技术利用目标实现的数据依赖性来显著降低现有灰盒攻击应用在白盒密码学的复杂性。本论文除了介绍的理论分析和新的攻击技术外，还报告了一些针对实际白盒实现的攻击实验。特别的是，我们连续两届打破了著名的WhibOx白盒密码学竞赛中的获胜实现。</p></div></div><div id=footer class=mb-5><hr><div class="container text-center"><span><a href=https://github.com/junwei-wang><small>By Junwei Wang</small></a></span>
&nbsp;
<small><i class="bi bi-dot"></i></small>&nbsp;
<a href=https://github.com/junwei-wang><small><i class=bi-github role=img></i></small></a>&nbsp;
<a href=https://linkedin.com/in/junweiwang><small><i class=bi-linkedin role=img></i></small></a>&nbsp;
<a href=https://twitter.com/junwei_wang><small><i class=bi-twitter role=img></i></small></a>&nbsp;
<small><i class="bi bi-dot"></i></small>&nbsp;
<a href="https://scholar.google.com/citations?user=GNG2enMAAAAJ"><small><i class="ai ai-google-scholar" role=img></i></small></a>&nbsp;
<a href=https://dblp.uni-trier.de/pid/81/4816-3.html><small><i class="ai ai-dblp" role=img></i></small></a></div></div></body></html>